[importlinter]
root_packages = core, infra, apps

[contract:layers]
name = Enforce Clean Architecture layers
type = layers
layers =
    core
    infra
    apps

[contract:core_no_apps_infra]
name = Core must not import apps/infra
type = forbidden
source_modules = core
forbidden_modules =
    apps
    infra

[contract:infra_no_apps]
name = Infra must not import apps
type = forbidden
source_modules = infra
forbidden_modules =
    apps

[contract:apps_composition_roots_only]
name = Apps can only import infra in composition roots (DI containers)
type = forbidden
source_modules = 
    apps.api.routers
    apps.api.services
    apps.api.middleware
    apps.bot.handlers
    apps.bot.services
    apps.bot.middlewares
    apps.bot.utils
    apps.mtproto.collectors
    apps.jobs.tasks
forbidden_modules =
    infra