
==================================== ERRORS ====================================
_____________________ ERROR collecting test_superadmin.py ______________________
ImportError while importing test module '/home/runner/work/analyticbot/analyticbot/test_superadmin.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/importlib/__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
test_superadmin.py:20: in <module>
    from core.services.superadmin_service import SuperAdminService
core/services/superadmin_service.py:11: in <module>
    from passlib.context import CryptContext
E   ModuleNotFoundError: No module named 'passlib'
_______________ ERROR collecting tests/test_analytics_service.py _______________
ImportError while importing test module '/home/runner/work/analyticbot/analyticbot/tests/test_analytics_service.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/importlib/__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_analytics_service.py:6: in <module>
    from apps.bot.database.repositories.analytics_repository import AnalyticsRepository
E   ModuleNotFoundError: No module named 'apps.bot.database.repositories.analytics_repository'
______________ ERROR collecting tests/test_content_protection.py _______________
tests/test_content_protection.py:20: in <module>
    from apps.bot.services.content_protection import (
apps/bot/services/__init__.py:1: in <module>
    from .analytics_service import AnalyticsService
apps/bot/services/analytics_service.py:15: in <module>
    from apps.bot.database.performance import (
apps/bot/database/performance.py:19: in <module>
    from apps.bot.config import settings
apps/bot/config.py:8: in <module>
    from config.settings import Settings as MainSettings
config/__init__.py:5: in <module>
    from .settings import settings
config/settings.py:183: in <module>
    settings = Settings()
               ^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic_settings/main.py:188: in __init__
    super().__init__(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for Settings
E   BOT_TOKEN
E     Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.9/v/missing
E   STORAGE_CHANNEL_ID
E     Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.9/v/missing
E   TWA_HOST_URL
E     Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.9/v/missing
E   JWT_SECRET_KEY
E     Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.9/v/missing
__________ ERROR collecting tests/test_content_protection_isolated.py __________
tests/test_content_protection_isolated.py:18: in <module>
    from models.content_protection import (
apps/bot/models/content_protection.py:130: in <module>
    class ContentProtection(BaseORMModel):
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_api.py:198: in __init__
    _as_declarative(reg, cls, dict_)
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py:245: in _as_declarative
    return _MapperConfig.setup_mapping(registry, cls, dict_, None, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py:326: in setup_mapping
    return _ClassScanMapperConfig(
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py:577: in __init__
    self._setup_table(table)
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py:1762: in _setup_table
    table_cls(
<string>:2: in __new__
    ???
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/util/deprecations.py:281: in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/sql/schema.py:429: in __new__
    return cls._new(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/sql/schema.py:461: in _new
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: Table 'content_protections' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
_________________ ERROR collecting tests/test_guard_service.py _________________
ImportError while importing test module '/home/runner/work/analyticbot/analyticbot/tests/test_guard_service.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/importlib/__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_guard_service.py:1: in <module>
    import fakeredis.aioredis
E   ModuleNotFoundError: No module named 'fakeredis'
=========================== short test summary info ============================
ERROR test_superadmin.py
ERROR tests/test_analytics_service.py
ERROR tests/test_content_protection.py - pydantic_core._pydantic_core.ValidationError: 4 validation errors for Settings
BOT_TOKEN
  Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
STORAGE_CHANNEL_ID
  Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
TWA_HOST_URL
  Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
JWT_SECRET_KEY
  Field required [type=missing, input_value={'POSTGRES_USER': 'analyt...redis://localhost:6379'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
ERROR tests/test_content_protection_isolated.py - sqlalchemy.exc.InvalidRequestError: Table 'content_protections' is already defined for this MetaData instance.  Specify 'extend_existing=True' to redefine options and columns on an existing Table object.
ERROR tests/test_guard_service.py
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 5 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
