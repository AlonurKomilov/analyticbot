{
  "total_files_analyzed": 102,
  "layer_dependencies": {
    "core": [
      "infra"
    ],
    "infra": [
      "core"
    ]
  },
  "circular_dependencies": [
    [
      "core",
      "infra"
    ],
    [
      "infra",
      "core"
    ]
  ],
  "migration_priority": [
    [
      "core/protocols.py",
      0
    ],
    [
      "core/__init__.py",
      0
    ],
    [
      "core/repositories/__init__.py",
      0
    ],
    [
      "core/repositories/shared_reports_repository.py",
      0
    ],
    [
      "core/repositories/interfaces.py",
      0
    ],
    [
      "core/repositories/alert_repository.py",
      0
    ],
    [
      "core/ports/tg_client.py",
      0
    ],
    [
      "core/ports/mtproto_config.py",
      0
    ],
    [
      "core/ports/__init__.py",
      0
    ],
    [
      "core/ports/analytics_client.py",
      0
    ],
    [
      "core/security_engine/config.py",
      0
    ],
    [
      "core/security_engine/mfa.py",
      0
    ],
    [
      "core/security_engine/container.py",
      0
    ],
    [
      "core/security_engine/auth.py",
      0
    ],
    [
      "core/security_engine/__init__.py",
      0
    ],
    [
      "core/security_engine/models.py",
      0
    ],
    [
      "core/security_engine/oauth.py",
      0
    ],
    [
      "core/security_engine/auth_utils.py",
      0
    ],
    [
      "core/security_engine/rbac.py",
      0
    ],
    [
      "core/models/base.py",
      0
    ],
    [
      "core/models/admin.py",
      0
    ],
    [
      "core/models/__init__.py",
      0
    ],
    [
      "core/models/common.py",
      0
    ],
    [
      "core/services/enhanced_delivery_service.py",
      0
    ],
    [
      "core/services/superadmin_service.py",
      0
    ],
    [
      "core/services/__init__.py",
      0
    ],
    [
      "core/services/analytics_fusion_service.py",
      0
    ],
    [
      "core/common_helpers/idempotency.py",
      0
    ],
    [
      "core/common_helpers/__init__.py",
      0
    ],
    [
      "core/common_helpers/health_check.py",
      0
    ],
    [
      "core/common_helpers/ratelimit.py",
      0
    ],
    [
      "core/common/health/checker.py",
      0
    ],
    [
      "core/common/health/__init__.py",
      0
    ],
    [
      "core/common/health/models.py",
      0
    ],
    [
      "apps/bot/container.py",
      0
    ],
    [
      "infra/__init__.py",
      0
    ],
    [
      "infra/obs/otel.py",
      0
    ],
    [
      "infra/email/__init__.py",
      0
    ],
    [
      "infra/email/smtp_email_service.py",
      0
    ],
    [
      "infra/db/connection_manager.py",
      0
    ],
    [
      "infra/db/__init__.py",
      0
    ],
    [
      "infra/db/connection.py",
      0
    ],
    [
      "infra/helm/validate_structure.py",
      0
    ],
    [
      "infra/helm/validate_helm.py",
      0
    ],
    [
      "infra/monitoring/task_optimization.py",
      0
    ],
    [
      "infra/monitoring/worker_metrics.py",
      0
    ],
    [
      "infra/testing/load_testing.py",
      0
    ],
    [
      "infra/rendering/__init__.py",
      0
    ],
    [
      "infra/cache/redis_cache.py",
      0
    ],
    [
      "infra/cache/advanced_decorators.py",
      0
    ],
    [
      "infra/cache/redis_client.py",
      0
    ],
    [
      "infra/logging/structlog_config.py",
      0
    ],
    [
      "infra/tg/parsers.py",
      0
    ],
    [
      "infra/tg/account_pool.py",
      0
    ],
    [
      "infra/tg/__init__.py",
      0
    ],
    [
      "infra/tg/stats_parsers.py",
      0
    ],
    [
      "infra/tg/dc_router.py",
      0
    ],
    [
      "infra/tg/proxy_pool.py",
      0
    ],
    [
      "infra/celery/celery_app.py",
      0
    ],
    [
      "infra/celery/__init__.py",
      0
    ],
    [
      "infra/common/__init__.py",
      0
    ],
    [
      "infra/common/ratelimit.py",
      0
    ],
    [
      "infra/common/faults.py",
      0
    ],
    [
      "infra/db/repositories/payment_repository.py",
      0
    ],
    [
      "infra/db/repositories/post_metrics_repository.py",
      0
    ],
    [
      "infra/db/repositories/__init__.py",
      0
    ],
    [
      "infra/db/repositories/channel_daily_repository.py",
      0
    ],
    [
      "infra/db/repositories/channel_repository.py",
      0
    ],
    [
      "infra/db/repositories/stats_raw_repository.py",
      0
    ],
    [
      "infra/db/repositories/post_repository.py",
      0
    ],
    [
      "infra/db/repositories/edges_repository.py",
      0
    ],
    [
      "infra/db/repositories/plan_repository.py",
      0
    ],
    [
      "infra/db/repositories/analytics_repository.py",
      0
    ],
    [
      "infra/db/alembic/env.py",
      0
    ],
    [
      "infra/db/alembic/versions/0005_payment_system.py",
      0
    ],
    [
      "infra/db/alembic/versions/0004_unique_sent_posts.py",
      0
    ],
    [
      "infra/db/alembic/versions/0008_create_superadmin_system.py",
      0
    ],
    [
      "infra/db/alembic/versions/0010_analytics_fusion_optimizations.py",
      0
    ],
    [
      "infra/db/alembic/versions/0009_content_protection_system.py",
      0
    ],
    [
      "infra/db/alembic/versions/0011_phase_4_5_bot_ui_alerts.py",
      0
    ],
    [
      "infra/db/alembic/versions/51ba01a1cb0e_critical_fix_cascade_delete_constraints_.py",
      0
    ],
    [
      "infra/db/alembic/versions/0003_add_indexes.py",
      0
    ],
    [
      "infra/db/alembic/versions/0015_merge_analytics_and_performance.py",
      0
    ],
    [
      "infra/db/alembic/versions/0011_bot_ui_alerts.py",
      0
    ],
    [
      "infra/db/alembic/versions/0007_mtproto_stats_tables.py",
      0
    ],
    [
      "infra/db/alembic/versions/0001_initial_schema.py",
      0
    ],
    [
      "infra/db/alembic/versions/0006_deliveries_observability.py",
      0
    ],
    [
      "infra/db/alembic/versions/0012_add_performance_indexes_for_key_tables.py",
      0
    ],
    [
      "infra/db/alembic/versions/0014_performance_critical_indexes.py",
      0
    ],
    [
      "infra/db/alembic/versions/0016_critical_fix_cascade_delete_constraints.py",
      0
    ],
    [
      "infra/db/alembic/versions/0013_add_advanced_performance_indexes.py",
      0
    ],
    [
      "infra/db/alembic/versions/0002_seed_plans.py",
      0
    ],
    [
      "infra/rendering/charts.py",
      1
    ],
    [
      "infra/cache/async_redis_client.py",
      1
    ],
    [
      "infra/db/repositories/admin_repository.py",
      1
    ],
    [
      "infra/db/repositories/user_repository.py",
      1
    ],
    [
      "infra/db/repositories/shared_reports_repository.py",
      1
    ],
    [
      "infra/db/repositories/alert_repository.py",
      1
    ],
    [
      "infra/tg/telethon_client.py",
      2
    ],
    [
      "infra/celery/tasks.py",
      2
    ],
    [
      "infra/db/repositories/schedule_repository.py",
      2
    ],
    [
      "core/di_container.py",
      3
    ]
  ],
  "proposed_mapping": {
    "core/models/": "src/shared_kernel/domain/entities/",
    "core/services/analytics_*": "src/analytics/application/services/",
    "core/services/payment_*": "src/payments/application/services/",
    "core/services/user_*": "src/identity/application/services/",
    "core/repositories/": "src/*/domain/repositories/",
    "core/security_engine/": "src/security/",
    "core/ports/": "src/shared_kernel/domain/ports/",
    "infra/db/repositories/": "src/*/infrastructure/persistence/",
    "infra/cache/": "src/shared_kernel/infrastructure/cache/",
    "infra/email/": "src/shared_kernel/infrastructure/email/",
    "infra/monitoring/": "src/shared_kernel/infrastructure/monitoring/",
    "apps/api/": "src/api_service/presentation/",
    "apps/bot/": "src/bot_service/presentation/"
  }
}